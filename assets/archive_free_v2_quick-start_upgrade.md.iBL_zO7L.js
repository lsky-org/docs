import{_ as o,c,a2 as t,o as a}from"./chunks/framework.CehHI-68.js";const h=JSON.parse('{"title":"升级","description":"升级兰空图床","frontmatter":{"title":"升级","description":"升级兰空图床"},"headers":[],"relativePath":"archive/free/v2/quick-start/upgrade.md","filePath":"zh/archive/free/v2/quick-start/upgrade.md","lastUpdated":1731937013000}'),r={name:"archive/free/v2/quick-start/upgrade.md"};function l(d,e,i,s,p,n){return a(),c("div",null,e[0]||(e[0]=[t('<h2 id="在线升级" tabindex="-1">在线升级 <a class="header-anchor" href="#在线升级" aria-label="Permalink to &quot;在线升级&quot;">​</a></h2><p>兰空图床支持从 web 端直接升级版本，但不会提醒有新版本发布，如果你希望在新版本发布时得到通知，可以前往 <a href="https://github.com/lsky-org/lsky-pro" target="_blank" rel="noreferrer">https://github.com/lsky-org/lsky-pro</a>，然后点击右上角的 <code>Watch</code> 展开后选择 <code>Custom</code>，勾选 <code>Releases</code> 然后点击 <code>Apply</code> 即可。</p><p>新版本发布以后，等待大约三分钟后可以打开兰空图床系统设置，滚动至最底部，会出现新版本的升级信息。</p><h2 id="手动升级" tabindex="-1">手动升级 <a class="header-anchor" href="#手动升级" aria-label="Permalink to &quot;手动升级&quot;">​</a></h2><p>如果在线升级失败，可以尝试手动升级。首先你需要前往 <a href="https://github.com/lsky-org/lsky-pro/releases" target="_blank" rel="noreferrer">https://github.com/lsky-org/lsky-pro/releases</a> 找到最新的版本，下载完整的安装包。(如果你不是开发人员，请<strong>不要</strong>下载名为 <code>Source code</code> 的压缩包，此为未安装依赖的源码包)</p><p>然后按照以下步骤进行升级：</p><ol><li>备份 <code>storage</code> 和 <code>public</code> 目录下的缩略图文件夹(默认该文件夹名称为 <code>thumbnails</code>)</li><li>删除 <strong>除了</strong> 目录 <code>.env</code> 文件和 <code>installed.lock</code> 文件以外的所有文件夹以及文件</li><li>解压新版本到程序根目录(替换掉旧版本)</li><li>将备份的 <code>storage</code> 文件夹替换掉<strong>已解压</strong>的 <code>storage</code> 文件夹，将备份的缩略图文件夹放到 <code>public</code> 目录下</li><li>修改版本号，进入数据库找到 <code>configs</code> 表，修改 <code>name</code> 为 <code>app_version</code> 的 <code>value</code> 值，例如 <code>V 2.0</code>，字符串必须完全一致。</li><li>进入程序根目录执行依次执行以下命令(需要PHP 8+) <ul><li><code>php artisan migrate --seed</code></li><li><code>php artisan optimize:clear</code></li></ul></li></ol><div class="danger custom-block"><p class="custom-block-title">本地储存以及使用 sqlite 需要注意的事情</p><ul><li>使用 sqlite 默认情况下会将数据库文件放置 <code>database</code> 文件夹下，请在升级之前备份该数据库文件，并在上述第三步操作以后将数据库文件放置原位。</li><li>本地储存策略的所有上传的图片都会保存在 <code>storage</code> 文件夹下，数据无价，请注意备份该文件夹。</li><li>本地储存策略会在 <code>public</code> 文件夹下生成符号连接(软连接)，删除 <code>public</code> 目录后，请在升级完成以后编辑本地储存策略，保存一下以重新生成符号连接。</li></ul></div>',8)]))}const g=o(r,[["render",l]]);export{h as __pageData,g as default};
